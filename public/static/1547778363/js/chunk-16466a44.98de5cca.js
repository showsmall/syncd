(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16466a44"],{"24d2":function(t,e,n){"use strict";n.d(e,"m",function(){return r}),n.d(e,"r",function(){return c}),n.d(e,"l",function(){return s}),n.d(e,"h",function(){return o}),n.d(e,"f",function(){return i}),n.d(e,"b",function(){return u}),n.d(e,"j",function(){return l}),n.d(e,"n",function(){return p}),n.d(e,"s",function(){return d}),n.d(e,"i",function(){return h}),n.d(e,"g",function(){return f}),n.d(e,"e",function(){return b}),n.d(e,"c",function(){return g}),n.d(e,"a",function(){return j}),n.d(e,"k",function(){return m}),n.d(e,"o",function(){return v}),n.d(e,"q",function(){return _}),n.d(e,"p",function(){return O}),n.d(e,"d",function(){return U});n("cadf"),n("551c"),n("097d");var a=n("e1d2");function r(t){return Object(a["b"])("/project/new",t)}function c(t){return Object(a["b"])("/project/update",t)}function s(t){return Object(a["a"])("/project/list",t)}function o(t){return Object(a["a"])("/project/detail",t)}function i(t){return Object(a["b"])("/project/delete",t)}function u(t){return Object(a["b"])("/project/status/change",t)}function l(t){return Object(a["a"])("/project/space/list",t)}function p(t){return Object(a["b"])("/project/space/new",t)}function d(t){return Object(a["b"])("/project/space/update",t)}function h(t){return Object(a["a"])("/project/space/detail",t)}function f(t){return Object(a["b"])("/project/space/delete",t)}function b(t){return Object(a["a"])("/project/space/exists",t)}function g(t){return Object(a["a"])("/project/exists",t)}function j(t){return Object(a["b"])("/project/user/add",t)}function m(t){return Object(a["a"])("/project/user/list",t)}function v(t){return Object(a["b"])("/project/user/remove",t)}function _(t){return Object(a["a"])("/project/user/search",t)}function O(t){return Object(a["b"])("/project/repo/reset",t)}function U(t){return Object(a["a"])("/project/server/check",t)}},"2baf":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-card",{staticClass:"app-card",attrs:{title:"成员管理",bordered:!1}},[t.$root.CheckPriv(t.$root.Priv.PROJECT_USER_NEW)?[n("div",{staticClass:"app-btn-group"},[n("div",{staticStyle:{"margin-bottom":"15px"}},[t._v("添加新成员到 "),n("strong",[t._v(t._s(this.spaceDetail.name))]),t._v(" 项目空间")]),n("a-row",{attrs:{gutter:10}},[n("a-col",{attrs:{span:12}},[n("a-select",{staticStyle:{width:"100%"},attrs:{labelInValue:"",showSearch:"",allowClear:"",defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,notFoundContent:t.searchFetching?void 0:"未找到用户",placeholder:"通过用户名、邮箱搜索用户"},on:{search:t.handleSearchUser},model:{value:t.selectedUser,callback:function(e){t.selectedUser=e},expression:"selectedUser"}},[t.searchFetching?n("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):t._e(),t._l(t.searchUserList,function(e){return n("a-select-option",{attrs:{value:""+e.id}},[t._v("\n                                "+t._s(e.name)+" - "+t._s(e.email)+" - "+t._s(e.group_name)+"\n                            ")])})],2)],1),n("a-col",{attrs:{span:8}},[n("a-button",{attrs:{type:"primary"},on:{click:t.handleAppendUser}},[t._v("添加")])],1)],1)],1),n("a-divider")]:t._e(),n("a-table",{attrs:{columns:t.tableColumns,dataSource:t.tableSource,pagination:t.pagination,loading:t.tableLoading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"lock_status",fn:function(e,a){return n("span",{},[1==e?[n("a-tooltip",{attrs:{placement:"top"}},[n("template",{slot:"title"},[n("span",[t._v("用户可正常登陆")])]),n("span",{staticClass:"app-color-success"},[n("a-icon",{attrs:{type:"unlock"}}),t._v(" 正常")],1)],2)]:t._e(),0==e?[n("a-tooltip",{attrs:{placement:"top"}},[n("template",{slot:"title"},[n("span",[t._v("用户被锁定，禁止登录")])]),n("span",{staticClass:"app-color-gray"},[n("a-icon",{attrs:{type:"lock"}}),t._v(" 锁定")],1)],2)]:t._e()],2)}},{key:"op",fn:function(e,a){return n("span",{},[t.$root.CheckPriv(t.$root.Priv.PROJECT_USER_DEL)?n("a-popconfirm",{attrs:{title:"确定要移除吗？",okText:"移除",cancelText:"取消"},on:{confirm:function(e){t.handleRemoveUser(a.id)}}},[n("span",{staticClass:"app-link app-op app-remove"},[n("a-icon",{attrs:{type:"delete"}}),t._v("移除")],1)]):t._e()],1)}}])})],2)],1)},r=[],c=(n("cadf"),n("551c"),n("097d"),n("24d2")),s={data:function(){return{spaceDetail:{},selectedUser:{},searchUserTimer:null,searchFetching:!1,searchUserList:[],tableLoading:!1,tableColumns:[{dataIndex:"name",title:"用户名"},{dataIndex:"email",title:"邮箱"},{dataIndex:"group_name",title:"角色",width:"15%"},{dataIndex:"lock_status",title:"状态",width:"10%",scopedSlots:{customRender:"lock_status"}},{dataIndex:"op",title:"操作",width:"10%",align:"right",scopedSlots:{customRender:"op"}}],tableSource:[],pagination:{pageSize:10,current:1,total:0}}},methods:{handleSearchUser:function(t){clearTimeout(this.searchUserTimer);var e=this;e.searchFetching=!0,e.searchUserList=[],e.searchUserTimer=setTimeout(function(){Object(c["q"])({keyword:t}).then(function(t){e.searchUserList=t.list,e.searchFetching=!1}).catch(function(t){e.searchFetching=!1})},500)},handleAppendUser:function(){var t=this;this.selectedUser||this.$message.error("请先选择用户再添加"),Object(c["a"])({space_id:this.spaceId,user_id:this.selectedUser.key}).then(function(e){t.$message.success("用户添加成功"),t.selectedUser=void 0,t.handleTableChange(t.pagination)}).catch(function(e){t.$message.error("用户添加失败, "+e.message),t.selectedUser=void 0}),this.searchUserList=[]},handleTableChange:function(t){this.pagination.current=t.current,this.getDataList({page:t.current,pageSize:t.pageSize})},handleRemoveUser:function(t){var e=this;Object(c["o"])({id:t}).then(function(t){e.$message.success("移除成功",1),e.$root.ResetPagination(e.pagination),e.handleTableChange(e.pagination)})},getDataList:function(t){var e=this;this.tableLoading=!0;var n=(t.page-1)*t.pageSize;Object(c["k"])({spaceId:this.spaceId,offset:n,limit:t.pageSize}).then(function(t){e.tableLoading=!1,e.pagination.total=t.total,e.tableSource=t.list}).catch(function(t){e.tableLoading=!1})},getSpaceDetail:function(t){var e=this;Object(c["i"])({id:t}).then(function(t){e.spaceDetail=t})}},mounted:function(){var t=parseInt(this.$route.query.space);t||this.$root.GotoRouter("projectSpace"),this.spaceId=t,this.getSpaceDetail(this.spaceId),this.handleTableChange(this.pagination)}},o=s,i=n("2877"),u=Object(i["a"])(o,a,r,!1,null,null,null);u.options.__file="User.vue";e["default"]=u.exports}}]);