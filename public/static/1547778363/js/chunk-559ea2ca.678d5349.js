(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-559ea2ca"],{"214f":function(t,e,a){"use strict";var n=a("32e9"),i=a("2aba"),o=a("79e5"),r=a("be13"),s=a("2b4c");t.exports=function(t,e,a){var l=s(t),c=a(r,l,""[t]),u=c[0],d=c[1];o(function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})&&(i(String.prototype,t,u),n(RegExp.prototype,l,2==e?function(t,e){return d.call(t,this,e)}:function(t){return d.call(t,this)}))}},"386d":function(t,e,a){a("214f")("search",1,function(t,e,a){return[function(a){"use strict";var n=t(this),i=void 0==a?void 0:a[e];return void 0!==i?i.call(a,n):new RegExp(a)[e](String(n))},a]})},"92fa":function(t,e){var a=/^(attrs|props|on|nativeOn|class|style|hook)$/;function n(t,e){return function(){t&&t.apply(this,arguments),e&&e.apply(this,arguments)}}t.exports=function(t){return t.reduce(function(t,e){var i,o,r,s,l;for(r in e)if(i=t[r],o=e[r],i&&a.test(r))if("class"===r&&("string"===typeof i&&(l=i,t[r]=i={},i[l]=!0),"string"===typeof o&&(l=o,e[r]=o={},o[l]=!0)),"on"===r||"nativeOn"===r||"hook"===r)for(s in o)i[s]=n(i[s],o[s]);else if(Array.isArray(i))t[r]=i.concat(o);else if(Array.isArray(o))t[r]=[i].concat(o);else for(s in o)i[s]=o[s];else t[r]=e[r];return t},{})}},9419:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-card",{staticClass:"app-card",attrs:{bordered:!1}},[a("div",{staticClass:"app-btn-group"},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{span:4}},[t.$root.CheckPriv(t.$root.Priv.USER_NEW)?a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.handleOpenAddDialog}},[t._v("新增用户")]):t._e()],1),a("a-col",{attrs:{span:12}}),a("a-col",{attrs:{span:8}},[a("a-input-search",{attrs:{placeholder:"关键词搜索，ID、手机号、用户名",enterButton:""},on:{search:t.handleSearch},model:{value:t.search.keyword,callback:function(e){t.$set(t.search,"keyword",e)},expression:"search.keyword"}})],1)],1)],1),a("a-table",{attrs:{columns:t.tableColumns,dataSource:t.tableSource,pagination:t.pagination,loading:t.tableLoading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"last_login_time",fn:function(e,n){return a("span",{},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("div",[t._v("Time "+t._s(t.$root.FormatDateTime(e)))]),a("div",[t._v("IP "+t._s(n.last_login_ip))])]),t._v("\n                    "+t._s(t.$root.FormatDateFromNow(e))+"\n                ")],2)],1)}},{key:"lock_status",fn:function(e,n){return a("span",{},[1==e?[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v("用户可正常登陆")])]),a("span",{staticClass:"app-color-success"},[a("a-icon",{attrs:{type:"unlock"}}),t._v(" 正常")],1)],2)]:t._e(),0==e?[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v("用户被锁定，禁止登录")])]),a("span",{staticClass:"app-color-gray"},[a("a-icon",{attrs:{type:"lock"}}),t._v(" 锁定")],1)],2)]:t._e()],2)}},{key:"op",fn:function(e,n){return a("span",{},[t.$root.CheckPriv(t.$root.Priv.USER_EDIT)?a("span",{staticClass:"app-link app-op",on:{click:function(e){t.handleOpenEditDialog(n.id)}}},[a("a-icon",{attrs:{type:"edit"}}),t._v("编辑")],1):t._e(),t.$root.CheckPriv(t.$root.Priv.USER_DEL)?a("a-popconfirm",{attrs:{title:"确定要删除此用户吗？",okText:"删除",cancelText:"取消"},on:{confirm:function(e){t.handleDeleteUser(n.id)}}},[a("span",{staticClass:"app-link app-op app-remove"},[a("a-icon",{attrs:{type:"delete"}}),t._v("删除")],1)]):t._e()],1)}}])})],1),a("a-modal",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,confirmLoading:t.dialogConfirmLoading,keyboard:!1,maskClosable:!1,okText:"确定",cancelText:"取消",destroyOnClose:!0},on:{ok:t.dialogSubmit,cancel:t.dialogCancel}},[a("a-spin",{attrs:{spinning:t.dialogLoading}},[a("user-update-component",{ref:"updateRef",attrs:{detail:t.dialogDetail}})],1)],1)],1)},i=[],o=(a("386d"),a("c24f")),r=a("92fa"),s=a.n(r),l=(a("7f7f"),a("ac6a"),a("24b4")),c={render:function(){var t=arguments[0],e=this.form,a=e.getFieldDecorator,n=(e.getFieldValue,{labelCol:{span:6},wrapperCol:{span:16}});a("id",{initialValue:this.detail.id});var i=[];this.groupList.forEach(function(e){i.push(t("a-select-option",{attrs:{value:e.id}},[e.name]))});var r={validateTrigger:"blur"},l="";this.detail.id?(r.rules=[{type:"string",min:6,max:20,message:"密码必须为6-20个字符"}],l="不修改请留空"):r.rules=[{required:!0,message:"用户密码不能为空"},{type:"string",min:6,max:20,message:"密码必须为6-20个字符"}];var c=this,u=function(t,e){return function(a,n,i){if(n){var r="";switch(t){case"email":r="邮箱";break;case"name":r="用户名";break}c.$set(c.helps,t,"正在验证 ".concat(n," 是否被占用...")),Object(o["b"])({id:c.detail.id,keyword:n,type:t}).then(function(a){a.exists?(c.$set(c.helps,t,"抱歉！".concat(r,"已被占用，请重新输入")),i(e)):(c.$set(c.helps,t,void 0),i())}).catch(function(e){c.$set(c.helps,t,"网络错误, 校验失败"),i("网络错误, 校验失败")})}else i()}};return t("a-form",[t("a-form-item",s()([{props:n},{attrs:{label:"角色"}}]),[a("group_id",{rules:[{required:!0,message:"角色不能为空"}],initialValue:this.detail.group_id})(t("a-select",{style:"width: 100%"},[i]))]),t("a-form-item",s()([{props:n},{attrs:{help:this.helps.name,label:"用户名"}}]),[a("name",{rules:[{required:!0,message:"用户名不能为空"},{validator:u("name","用户名已经存在")}],initialValue:this.detail.name,validateTrigger:"blur"})(t("a-input",{attrs:{autocomplete:"off",placeholder:"请输入用户名"}}))]),t("a-form-item",s()([{props:n},{attrs:{extra:l,label:"密码"}}]),[a("password",r)(t("a-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入用户密码 6-20个字符"}}))]),t("a-form-item",s()([{props:n},{attrs:{help:this.helps.email,label:"邮箱"}}]),[a("email",{rules:[{required:!0,message:"邮箱地址不能为空"},{type:"email",message:"邮箱格式错误"},{validator:u("email","邮箱已经存在")}],initialValue:this.detail.email,validateTrigger:"blur"})(t("a-input",{attrs:{autocomplete:"off",placeholder:"请输入邮箱地址"}}))]),t("a-form-item",s()([{props:n},{attrs:{label:"真实姓名"}}]),[a("true_name",{initialValue:this.detail.true_name})(t("a-input",{attrs:{autocomplete:"off",placeholder:"请输入真实姓名"}}))]),t("a-form-item",s()([{props:n},{attrs:{label:"手机号"}}]),[a("mobile",{rules:[{validator:function(t,e,a){e||a(),/^1[3456789][0-9]{9}$/.test(e)&&a(),a("手机号格式错误")}}],initialValue:this.detail.mobile,validateTrigger:"blur"})(t("a-input",{attrs:{autocomplete:"off",placeholder:"11位数字，目前只支持中国(+86)手机号"}}))]),t("a-form-item",s()([{props:n},{attrs:{help:"禁止后用户将无法登录",label:"允许登录"}}]),[a("lock_status",{initialValue:!!this.detail.lock_status,valuePropName:"checked"})(t("a-switch",[t("a-icon",{attrs:{type:"unlock"},slot:"checkedChildren"}),t("a-icon",{attrs:{type:"lock"},slot:"unCheckedChildren"})]))])])},data:function(){return{groupList:[],helps:{}}},props:{detail:{default:function(){return{}},type:Object}},methods:{getUserGroupList:function(){var t=this;Object(o["f"])({offset:0,limit:9999}).then(function(e){t.groupList=e.list})}},mounted:function(){this.getUserGroupList()}},u=l["Form"].create()(c),d={data:function(){return{search:{},tableColumns:[{dataIndex:"name",title:"用户名"},{dataIndex:"email",title:"邮箱"},{dataIndex:"group_name",title:"角色",width:"15%"},{dataIndex:"lock_status",title:"状态",width:"10%",scopedSlots:{customRender:"lock_status"}},{dataIndex:"last_login_time",title:"上次登录",width:"15%",scopedSlots:{customRender:"last_login_time"}},{dataIndex:"op",title:"操作",width:"15%",align:"right",scopedSlots:{customRender:"op"}}],tableSource:[],pagination:{pageSize:10,current:1,total:0},tableLoading:!1,userGroupList:{},dialogTitle:"",dialogVisible:!1,dialogConfirmLoading:!1,dialogLoading:!1,dialogDetail:{}}},components:{UserUpdateComponent:u},methods:{handleTableChange:function(t){this.pagination.current=t.current,this.getDataList({page:t.current,pageSize:t.pageSize})},handleOpenAddDialog:function(){this.dialogTitle="新增用户",this.dialogVisible=!0,this.dialogDetail={}},handleOpenEditDialog:function(t){this.dialogTitle="编辑用户",this.dialogVisible=!0,this.dialogDetail={},this.getDataDetail(t)},handleSearch:function(t){this.search.keyword=t,this.pagination.current=1,this.handleTableChange(this.pagination)},handleDeleteUser:function(t){var e=this;Object(o["d"])({id:t}).then(function(t){e.$message.success("删除成功",1),e.$root.ResetPagination(e.pagination),e.handleTableChange(e.pagination)})},dialogSubmit:function(){var t=this;this.$refs.updateRef.validateFields(function(e,a){e||(t.dialogConfirmLoading=!0,a.password&&(a.password=t.$root.Md5Sum(a.password)),a.lock_status=a.lock_status?1:0,t.dialogDetail.id?Object(o["r"])(a).then(function(e){t.$message.success("用户信息更新成功",1,function(){t.dialogCancel(),t.dialogConfirmLoading=!1,t.handleTableChange(t.pagination)})}).catch(function(e){t.dialogConfirmLoading=!1}):Object(o["n"])(a).then(function(e){t.$message.success("用户创建成功",1,function(){t.dialogCancel(),t.dialogConfirmLoading=!1,t.handleTableChange(t.pagination)})}).catch(function(e){t.dialogConfirmLoading=!1}))})},dialogCancel:function(){this.dialogVisible=!1},getDataList:function(t){var e=this;this.tableLoading=!0;var a=(t.page-1)*t.pageSize,n=this.search.keyword;Object(o["i"])({keyword:n,offset:a,limit:t.pageSize}).then(function(t){e.tableLoading=!1,e.pagination.total=t.total,e.tableSource=t.list}).catch(function(t){e.tableLoading=!1})},getDataDetail:function(t){var e=this;this.dialogLoading=!0,Object(o["h"])({id:t}).then(function(t){e.dialogLoading=!1,e.dialogDetail=t}).catch(function(t){e.dialogLoading=!1})}},mounted:function(){this.handleTableChange(this.pagination)}},p=d,f=a("2877"),g=Object(f["a"])(p,n,i,!1,null,null,null);g.options.__file="User.vue";e["default"]=g.exports},c24f:function(t,e,a){"use strict";a.d(e,"a",function(){return i}),a.d(e,"m",function(){return o}),a.d(e,"o",function(){return r}),a.d(e,"f",function(){return s}),a.d(e,"e",function(){return l}),a.d(e,"c",function(){return c}),a.d(e,"g",function(){return u}),a.d(e,"n",function(){return d}),a.d(e,"r",function(){return p}),a.d(e,"i",function(){return f}),a.d(e,"h",function(){return g}),a.d(e,"b",function(){return h}),a.d(e,"d",function(){return m}),a.d(e,"j",function(){return b}),a.d(e,"l",function(){return v}),a.d(e,"k",function(){return k}),a.d(e,"p",function(){return _}),a.d(e,"q",function(){return y});var n=a("e1d2");function i(t){return Object(n["a"])("/user/group/checkexists",t)}function o(t){return Object(n["b"])("/user/group/new",t)}function r(t){return Object(n["b"])("/user/group/update",t)}function s(t){return Object(n["a"])("/user/group/list",t)}function l(t){return Object(n["a"])("/user/group/detail",t)}function c(t){return Object(n["b"])("/user/group/delete",t)}function u(){return Object(n["a"])("/user/group/priv")}function d(t){return Object(n["b"])("/user/new",t)}function p(t){return Object(n["b"])("/user/update",t)}function f(t){return Object(n["a"])("/user/list",t)}function g(t){return Object(n["a"])("/user/detail",t)}function h(t){return Object(n["a"])("/user/checkexists",t)}function m(t){return Object(n["b"])("/user/delete",t)}function b(t){return Object(n["b"])("/user/login",t)}function v(){return Object(n["b"])("/user/logout")}function k(){return Object(n["a"])("/user/login/status")}function _(t){return Object(n["b"])("/user/my/update",t)}function y(t){return Object(n["b"])("/user/my/password",t)}}}]);